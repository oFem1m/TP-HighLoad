# Расчётно-пояснительная записка

## Тема и целевая аудитория

В качестве сервиса для проектирования был выбран **iCloud** - облачное хранилище и синхронизационный сервис. Данный сервис отвечает требованиям к теме:

- **Имеет реальные аналоги**, доказывающие существование рыночной ниши — Google Drive, Dropbox, Microsoft OneDrive.
- **Аудитория сервиса** превышает 500 миллион активных пользователей в месяц.
  
| Регион                 | Количество пользователей |
|------------------------|--------------------------|
| **США**                | 119 млн                  |
| **Китай**              | 125 млн                  |
| **Европа** (5 стран)   | 56.7 млн                 |
| **Всего по миру**      | 850 млн                  |

Эти данные основаны на источниках: [Worldmetrics](https://worldmetrics.org/apple-icloud-statistics/) и [ChargeASAP](https://chargeasap.com/blogs/news/breakdown-of-iphone-users-by-country).
- **Имеет сложную архитектуру**.

## Функционал

Ключевой функционал для данного сервиса:

1. **Облачное хранилище данных**
   - Возможность загружать, хранить и управлять файлами в облаке, с доступом из любой точки мира. **Поддержка синхронизации** данных между устройствами в режиме реального времени. При включении функции Фото iCloud оригиналы фото автоматически начинают храниться в облаке, что позволяет экономить память устройства.

2. **Синхронизация данных между устройствами**
   - Автоматическая синхронизация контактов, фотографий, заметок, документов и других данных между устройствами Apple. Пользователи могут продолжать работу с одного устройства на другом без необходимости переносить данные вручную.

3. **Система резервного копирования**
   - Возможность создания резервных копий данных, включая настройки устройств, файлы и приложения. **Автоматическое резервное копирование** происходит при подключении устройства к Wi-Fi и зарядному устройству.

4. **Совместная работа и доступ к файлам**
   - Поддержка **общего доступа к файлам** и папкам с другими пользователями iCloud, например, из семьи пользователя, с возможностью редактирования и комментирования. Интеграция с приложениями для совместной работы, такими как Pages, Numbers, и Keynote.

5. **Безопасность и шифрование данных**
   - **Шифрование данных** как на уровне хранения, так и при передаче данных между устройствами и облаком гарантирует высокий уровень защиты данных пользователей.

## Сокращение до MVP

Для создания MVP (минимально жизнеспособного продукта) iCloud можно урезать функционал до следующих ключевых функций:

1. **Облачное хранилище данных** (с базовыми функциями загрузки и хранения файлов).
2. **Синхронизация данных между устройствами** (ограничена основными данными, такими как контакты и фотографии).
3. **Система резервного копирования** (с поддержкой резервного копирования основных данных устройства).
4. **Совместная работа и доступ к файлам** (с упрощенной функцией общего доступа без сложных прав редактирования).
5. **Безопасность и шифрование данных** (с базовым шифрованием данных при передаче).

### Продуктовые метрики
1. **Месячная аудитория (MAU)**: В 2023 году количество пользователей iCloud составляет более 850 миллионов активных пользователей по всему миру.
2. **Дневная аудитория (DAU)**: Примерно 119 млн пользователей в США и 125 млн в Китае, что позволяет предполагать значительное количество ежедневных активных пользователей, ориентировочно 10-20% от MAU, т.е. около 85-170 млн.
3. **Средний размер хранилища пользователя**: iCloud предлагает тарифные планы от 50GB до 12TB на пользователя. Бесплатно выдается 5GB. Средний объем хранилища может составлять около 50GB, в зависимости от типа пользователей [Apple Support](https://support.apple.com/en-us/108047) [Statista](https://www.statista.com/topics/1695/cloud-computing/).
4. **Среднее количество действий пользователя в день**: Наиболее частые операции — это синхронизация данных (фото, контакты) и доступ к файлам. Например, если учесть основные запросы синхронизации и резервного копирования, каждый пользователь может совершать 3-5 действий в день (загрузка фото, обновление документов и т.п.).

| Метрика                             | Значение                   |
|-------------------------------------|----------------------------|
| Месячная аудитория (MAU)            | 850 млн                    |
| Дневная аудитория (DAU)             | 85-170 млн                 |
| Средний размер хранилища на юзера   | 50 GB                      |
| Среднее количество действий в день  | 3-5 действий               |

### Технические метрики
1. **Размер хранения по типам данных**: Общие данные пользователей распределяются по категориям — фото, видео, документы. Основной объем занимают медиафайлы, что может составлять до 80% от общего объема хранения. Если средний объем хранения пользователя 50GB, это будет эквивалентно 14 эксабайт данных для всего сервиса (170000000 * 50 / 1024^3 + 680000000 * 5 / 1024^3)
2. **Сетевой трафик**:
   - **Пиковое потребление**: пиковая скорость может достигать 100-200 Гбит/с в зависимости от времени суток и региона.
   - **Суммарный суточный трафик**: составляет порядка нескольких петабайт в сутки.
3. **RPS (requests per second)**: Для таких операций, как загрузка данных, синхронизация и резервное копирование, запросы могут составлять от 10k до 100k запросов в секунду в часы пик.

| Метрика                     | Среднее значение   |
|-----------------------------|--------------------|
| Размер хранения (всего)     | 14 EB              |
| Сетевой трафик (в сутки)    | ~20-25 PB          | 
| RPS по запросам             | 10k–100k           |

### Сетевой трафик по типам операций:

1. **Регистрация и авторизация**:
   - Регистрация в системе требует передачи базовых данных пользователя (например, имя, email, пароли), что занимает около **5-10 МБ** на одну операцию.
   - Авторизация использует меньший объем данных — около **1-3 МБ** на запрос.
   - Если в день регистрируется 100 тысяч пользователей и авторизуются 17 миллионов, то дневной трафик от этих операций составит:
     - Регистрация: 100000 * 10 МБ = 1 ТБ
     - Авторизация: 17000000 * 3 МБ = 51 ТБ

2. **Загрузка и синхронизация фотографий**:
   - Каждая фотография на iPhone весит от **1 до 10 МБ** в зависимости от качества и формата (JPEG, HEIC).
   - Предположим, что каждый пользователь загружает в среднем 5 фото в день, что даёт следующий расчёт для 170 млн активных пользователей:
     - 170000000 * 5 МБ * 5 фото = 4.25 ПБ в день.

3. **Загрузка и синхронизация видео**:
   - Видео занимают гораздо больше места — от **100 МБ до 1 ГБ** за минуту видео в высоком качестве (например, 4K).
   - Предположим, что 10% пользователей загружают или синхронизируют по 1 минуте видео в день:
     - 170000000 * 10% * 1 минута * 500 МБ = 8.5 ПБ в день.

4. **Поиск контента (документы, фото и т.д.)**:
   - Поиск данных требует небольших объемов данных — около **0.5-1 МБ** за запрос.
   - Если каждый пользователь совершает 3-4 запроса в день:
     - 170000000 * 3 * 1 МБ = 510 ТБ в день.

5. **Резервное копирование**:
   - Основной объем резервных копий приходится на документы, настройки и мультимедиа. Это может занимать от **50 МБ до нескольких ГБ**.
   - Если 50% пользователей делают автоматические резервные копии один раз в неделю, а размер копии в среднем составляет 500 МБ, то дневной объем трафика будет:
     - 170000000 * 50% * (1/7) * 500 МБ = 6.07 ПБ в день.

6. **Остальные операции (доступ к документам, контакты и т.д.)**:
   - Мелкие операции, такие как синхронизация контактов и заметок, занимают значительно меньше трафика — от **0.1 до 1 МБ** за каждую операцию.
   - Общий трафик на эти операции можно оценить в **100-200 ТБ в день**.

### Итоговая таблица трафика:

| Действие                         | Трафик на одного пользователя | Общее количество пользователей | Общий трафик в день |
|-----------------------------------|-------------------------------|--------------------------------|---------------------|
| Регистрация и авторизация         | 1-10 МБ                       | 17  млн                        | 51  ТБ              |
| Загрузка и синхронизация фото     | 1-10 МБ за фото               | 170 млн                        | 4.25 ПБ             |
| Загрузка и синхронизация видео    | 500 МБ за минуту              | 17 млн (10% пользователей)     | 8.5 ПБ              |
| Поиск контента                   | 0.5-1 МБ за запрос            | 170 млн                        | 510 ТБ              |
| Резервное копирование            | 500 МБ за копию               | 85 млн (50%)                   | 6.07 ПБ             |
| Мелкие операции (контакты, документы) | 0.1-1 МБ                     | 170 млн                        | 100-200 ТБ          |

### Сетевой трафик по сумме:

Суммарный дневной трафик iCloud составит **примерно 20-25 ПБ** (включая все операции).

### Пиковые значения:

- **Пиковое потребление** может быть в 2-3 раза выше среднего из-за интенсивного использования в определённые часы (вечер, выходные), что дает до **600-700 Гбит/с** трафика.

